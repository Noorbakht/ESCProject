{"remainingRequest":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\src\\views\\Call.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\src\\views\\Call.vue","mtime":1587045508184},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgcmFpbmJvd1NESyBmcm9tICJyYWluYm93LXdlYi1zZGsiOw0KLy8gaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiQ2FsbCIsDQogIGNvbXBvbmVudHM6IHt9LA0KICBkYXRhOiAoKSA9PiAoew0KICAgIHN0YXJ0OiBmYWxzZSwNCiAgICBpc0Nvbm5lY3Rpbmc6IGZhbHNlLA0KICAgIGNhbmNlbGxlZDogZmFsc2UsDQogICAgY2FsbDogIiIsDQogICAgZXhpdDogZmFsc2UNCiAgfSksDQogIG1vdW50ZWQoKSB7DQogICAgbGV0IHNlbGYgPSB0aGlzOw0KICAgIHNlbGYuY2hlY2tDYWxsKCk7DQogICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmFnZW50SWQgIT0gIiIpIHsNCiAgICAgIHNlbGYuaXNDb25uZWN0aW5nID0gdHJ1ZTsNCiAgICAgIHNlbGYuc3RhcnRDYWxsKCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGNvbnNvbGUubG9nKCJhZ2VudCBpZCBlbXB0eSIpOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGNoZWNrQ2FsbDogZnVuY3Rpb24oKSB7DQogICAgICBpZiAocmFpbmJvd1NESy53ZWJSVEMuY2FuTWFrZUF1ZGlvVmlkZW9DYWxsKCkpIHsNCiAgICAgICAgY29uc29sZS5sb2coIkJyb3dzZXIgc3VwcG9ydHMgY2FsbHMiKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgY2FsbHMiKTsNCiAgICAgIH0NCiAgICAgIGlmIChyYWluYm93U0RLLndlYlJUQy5oYXNBQ2FtZXJhKCkpIHsNCiAgICAgICAgY29uc29sZS5sb2coIkJyb3dzZXIgc3VwcG9ydHMgdmlkZW8iKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdmlkZW8iKTsNCiAgICAgIH0NCiAgICAgIGlmIChyYWluYm93U0RLLndlYlJUQy5oYXNBTWljcm9waG9uZSgpKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIHN1cHBvcnRzIG1pY3JvcGhvbmUiKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgbWljcm9waG9uZSIpOw0KICAgICAgfQ0KICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcyAvL2F1dGhvcmlzZSB0aGUgYXBwbGljYXRpb24gdG8gYWNjZXNzIG1lZGlhIGRldmljZQ0KICAgICAgICAuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUsIHZpZGVvOiB0cnVlIH0pDQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgew0KICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7DQogICAgICAgICAgICB0cmFjay5zdG9wKCk7DQogICAgICAgICAgfSk7DQogICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcw0KICAgICAgICAgICAgLmVudW1lcmF0ZURldmljZXMoKQ0KICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGV2aWNlcykgew0KICAgICAgICAgICAgICBkZXZpY2VzLmZvckVhY2goZnVuY3Rpb24oZGV2aWNlKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGV2aWNlKTsNCiAgICAgICAgICAgICAgICBpZiAoZGV2aWNlLmRldmljZUlkID09PSAiZGVmYXVsdCIpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRldmljZSk7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkZXZpY2UubGFiZWwsICJpcyBhdmFpbGFibGUiKTsNCiAgICAgICAgICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLnVzZU1pY3JvcGhvbmUoImRlZmF1bHQiKTsNCiAgICAgICAgICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLnVzZVNwZWFrZXIoImRlZmF1bHQiKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgew0KICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIHN0YXJ0Q2FsbDogYXN5bmMgZnVuY3Rpb24oKSB7DQogICAgICBsZXQgc2VsZiA9IHRoaXM7DQogICAgICB0cnkgew0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLiRzdG9yZS5zdGF0ZS5hZ2VudElkKTsNCiAgICAgICAgbGV0IGNvbnRhY3QgPSBhd2FpdCByYWluYm93U0RLLmNvbnRhY3RzLnNlYXJjaEJ5SWQoDQogICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuYWdlbnRJZA0KICAgICAgICApOw0KICAgICAgICBjb25zb2xlLmxvZyhjb250YWN0KTsNCiAgICAgICAgbGV0IHJlcyA9IHJhaW5ib3dTREsud2ViUlRDLmNhbGxJbkF1ZGlvKGNvbnRhY3QpOw0KICAgICAgICBpZiAocmVzLmxhYmVsID09PSAiT0siKSB7DQogICAgICAgICAgY29uc29sZS5sb2coImNhbGxpbmciKTsNCiAgICAgICAgfQ0KICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKA0KICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLlJBSU5CT1dfT05XRUJSVENDQUxMU1RBVEVDSEFOR0VELA0KICAgICAgICAgIHNlbGYub25XZWJSVENDYWxsQ2hhbmdlZA0KICAgICAgICApOw0KICAgICAgICBzZWxmLnN0YXJ0ID0gdHJ1ZTsNCiAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgfQ0KICAgIH0sDQogICAgb25XZWJSVENDYWxsQ2hhbmdlZDogYXN5bmMgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgIGxldCBzZWxmID0gdGhpczsNCiAgICAgIHNlbGYuY2FsbCA9IGV2ZW50LmRldGFpbDsNCiAgICAgIGNvbnNvbGUubG9nKCJPbldlYlJUQ0NhbGxDaGFuZ2VkIGV2ZW50IiwgZXZlbnQuZGV0YWlsLnN0YXR1cyk7DQogICAgICBjb25zb2xlLmxvZyhzZWxmLmNhbGwuc3RhdHVzLnZhbHVlKTsNCiAgICAgIGlmIChzZWxmLmNhbGwuc3RhdHVzLnZhbHVlID09PSAiaW5jb21taW5nQ2FsbCIpIHsNCiAgICAgICAgLy8gWW91IGhhdmUgYW4gaW5jb21pbmcgY2FsbCwgZG8gc29tZXRoaW5nIGFib3V0IGl0Og0KICAgICAgICAvLyBEZXRlY3QgdGhlIHR5cGUgb2YgaW5jb21pbmcgY2FsbA0KDQogICAgICAgIGlmIChzZWxmLmNhbGwucmVtb3RlTWVkaWEgPT09IDMpIHsNCiAgICAgICAgICAvLyBUaGUgaW5jb21pbmcgY2FsbCBpcyBvZiB0eXBlIGF1ZGlvICsgdmlkZW8NCiAgICAgICAgICByYWluYm93U0RLLndlYlJUQy5hbnN3ZXJJblZpZGVvKHNlbGYuY2FsbCk7DQoNCiAgICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgI21pbml2aWRlbyBhbmQgI2xhcmdldmlkZW8gZWxlbWVudHMgd2l0aCB0aGUgdmlkZW8gc3RyZWFtcw0KDQogICAgICAgICAgcmFpbmJvd1NESy53ZWJSVEMuc2hvd0xvY2FsVmlkZW8oKTsNCiAgICAgICAgICByYWluYm93U0RLLndlYlJUQy5zaG93UmVtb3RlVmlkZW8oc2VsZi5jYWxsKTsNCiAgICAgICAgfSBlbHNlIGlmIChzZWxmLmNhbGwucmVtb3RlTWVkaWEgPT09IDEpIHsNCiAgICAgICAgICAvLyBUaGUgaW5jb21pbmcgY2FsbCBpcyBvZiB0eXBlIGF1ZGlvDQogICAgICAgICAgcmFpbmJvd1NESy53ZWJSVEMuYW5zd2VySW5BdWRpbyhzZWxmLmNhbGwpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9DQogIC8vIGVuZENhbGw6IGFzeW5jIGZ1bmN0aW9uKCkgew0KICAvLyAgIGxldCBzZWxmID0gdGhpczsNCiAgLy8gICBzZWxmLmV4aXQgPSB0cnVlOw0KICAvLyAgIGF3YWl0IHJhaW5ib3dTREsud2ViUlRDLnJlbGVhc2Uoc2VsZi5jYWxsKTsNCiAgLy8gICBjb25zb2xlLmxvZygiU2Vzc2lvbiBFbmRlZCIpOw0KICAvLyB9LA0KICAvLyBtb3ZlVG9DaGF0OiBhc3luYyBmdW5jdGlvbigpIHsNCiAgLy8gICBjb25zb2xlLmxvZygibW92aW5nIHRvIGNoYXQiKTsNCiAgLy8gICBhd2FpdCByYWluYm93U0RLLndlYlJUQy5yZWxlYXNlKHRoaXMuY2FsbCk7DQogIC8vICAgYXdhaXQgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiY2hhdGJvdCIgfSk7DQogIC8vIH0NCn07DQo="},{"version":3,"sources":["Call.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Call.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"call\" id=\"call\">\r\n    <transition name=\"fade\">\r\n      <Waitpage v-bind:isConnecting=\"isConnecting\" v-if=\"!start\" />\r\n    </transition>\r\n    <audio id=\"globalAudioTag\" autoplay></audio>\r\n    <video id=\"largevideo\" autoplay></video>\r\n    <video id=\"globalVideoTag\" autoplay style=\"display:none;\"></video>\r\n    <v-footer width=\"100%\" padless>\r\n      <v-btn id=\"endcall\" @click=\"endCall\" height=\"58px\" width=\"100%\" x-large depressed tile>\r\n        <h3>End Call</h3>\r\n      </v-btn>\r\n    </v-footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport rainbowSDK from \"rainbow-web-sdk\";\r\n// import axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"Call\",\r\n  components: {},\r\n  data: () => ({\r\n    start: false,\r\n    isConnecting: false,\r\n    cancelled: false,\r\n    call: \"\",\r\n    exit: false\r\n  }),\r\n  mounted() {\r\n    let self = this;\r\n    self.checkCall();\r\n    if (this.$store.state.agentId != \"\") {\r\n      self.isConnecting = true;\r\n      self.startCall();\r\n    } else {\r\n      console.log(\"agent id empty\");\r\n    }\r\n  },\r\n  methods: {\r\n    checkCall: function() {\r\n      if (rainbowSDK.webRTC.canMakeAudioVideoCall()) {\r\n        console.log(\"Browser supports calls\");\r\n      } else {\r\n        console.log(\"Browser does not support calls\");\r\n      }\r\n      if (rainbowSDK.webRTC.hasACamera()) {\r\n        console.log(\"Browser supports video\");\r\n      } else {\r\n        console.log(\"Browser does not support video\");\r\n      }\r\n      if (rainbowSDK.webRTC.hasAMicrophone()) {\r\n        console.log(\"Browser supports microphone\");\r\n      } else {\r\n        console.log(\"Browser does not support microphone\");\r\n      }\r\n      navigator.mediaDevices //authorise the application to access media device\r\n        .getUserMedia({ audio: true, video: true })\r\n        .then(function(stream) {\r\n          stream.getTracks().forEach(function(track) {\r\n            track.stop();\r\n          });\r\n          navigator.mediaDevices\r\n            .enumerateDevices()\r\n            .then(function(devices) {\r\n              devices.forEach(function(device) {\r\n                console.log(device);\r\n                if (device.deviceId === \"default\") {\r\n                  console.log(device);\r\n                  console.log(device.label, \"is available\");\r\n                  rainbowSDK.webRTC.useMicrophone(\"default\");\r\n                  rainbowSDK.webRTC.useSpeaker(\"default\");\r\n                }\r\n              });\r\n            })\r\n            .catch(function(error) {\r\n              console.log(error);\r\n            });\r\n        })\r\n        .catch(function(error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n    startCall: async function() {\r\n      let self = this;\r\n      try {\r\n        console.log(this.$store.state.agentId);\r\n        let contact = await rainbowSDK.contacts.searchById(\r\n          this.$store.state.agentId\r\n        );\r\n        console.log(contact);\r\n        let res = rainbowSDK.webRTC.callInAudio(contact);\r\n        if (res.label === \"OK\") {\r\n          console.log(\"calling\");\r\n        }\r\n        document.addEventListener(\r\n          rainbowSDK.webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED,\r\n          self.onWebRTCCallChanged\r\n        );\r\n        self.start = true;\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n    onWebRTCCallChanged: async function(event) {\r\n      let self = this;\r\n      self.call = event.detail;\r\n      console.log(\"OnWebRTCCallChanged event\", event.detail.status);\r\n      console.log(self.call.status.value);\r\n      if (self.call.status.value === \"incommingCall\") {\r\n        // You have an incoming call, do something about it:\r\n        // Detect the type of incoming call\r\n\r\n        if (self.call.remoteMedia === 3) {\r\n          // The incoming call is of type audio + video\r\n          rainbowSDK.webRTC.answerInVideo(self.call);\r\n\r\n          // Populate the #minivideo and #largevideo elements with the video streams\r\n\r\n          rainbowSDK.webRTC.showLocalVideo();\r\n          rainbowSDK.webRTC.showRemoteVideo(self.call);\r\n        } else if (self.call.remoteMedia === 1) {\r\n          // The incoming call is of type audio\r\n          rainbowSDK.webRTC.answerInAudio(self.call);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // endCall: async function() {\r\n  //   let self = this;\r\n  //   self.exit = true;\r\n  //   await rainbowSDK.webRTC.release(self.call);\r\n  //   console.log(\"Session Ended\");\r\n  // },\r\n  // moveToChat: async function() {\r\n  //   console.log(\"moving to chat\");\r\n  //   await rainbowSDK.webRTC.release(this.call);\r\n  //   await this.$router.push({ name: \"chatbot\" });\r\n  // }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.call {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100vh;\r\n  text-align: center;\r\n  padding: 20px;\r\n}\r\n.box {\r\n  height: 100%;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  justify-items: center;\r\n  align-content: center;\r\n  overflow: auto;\r\n}\r\n.agent-text {\r\n  text-align: center;\r\n  position: absolute;\r\n  width: 100%;\r\n  margin-top: 150px;\r\n}\r\n.header {\r\n  background-color: #f1f1f1;\r\n  text-align: center;\r\n  font-size: 60px;\r\n  width: 100%;\r\n  transition: 0.2s;\r\n}\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity 0.5s;\r\n}\r\n.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {\r\n  opacity: 0;\r\n}\r\n</style>\r\n"]}]}
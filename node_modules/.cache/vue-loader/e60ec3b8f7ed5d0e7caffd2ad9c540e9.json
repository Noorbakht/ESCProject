{"remainingRequest":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\src\\views\\Call.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\src\\views\\Call.vue","mtime":1587220067513},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\noorb\\OneDrive\\Desktop\\StarterKit-SDKWeb-VueJS-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgcmFpbmJvd1NESyBmcm9tICJyYWluYm93LXdlYi1zZGsiOw0KLy8gaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICJDYWxsIiwNCiAgICBjb21wb25lbnRzOiB7fSwNCiAgICBkYXRhOiAoKSA9PiAoew0KICAgICAgICBzdGFydDogZmFsc2UsDQogICAgICAgIGlzQ29ubmVjdGluZzogZmFsc2UsDQogICAgICAgIGNhbmNlbGxlZDogZmFsc2UsDQogICAgICAgIGNhbGw6ICIiLA0KICAgICAgICBleGl0OiBmYWxzZQ0KICAgIH0pLA0KICAgIG1vdW50ZWQoKSB7DQogICAgICAgIGxldCBzZWxmID0gdGhpczsNCiAgICAgICAgc2VsZi5jaGVja0NhbGwoKTsNCiAgICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmFnZW50SWQgIT0gIiIpIHsNCiAgICAgICAgICAgIHNlbGYuaXNDb25uZWN0aW5nID0gdHJ1ZTsNCiAgICAgICAgICAgIHNlbGYuc3RhcnRDYWxsKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygiYWdlbnQgaWQgZW1wdHkiKTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBjaGVja0NhbGw6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKHJhaW5ib3dTREsud2ViUlRDLmNhbk1ha2VBdWRpb1ZpZGVvQ2FsbCgpKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkJyb3dzZXIgc3VwcG9ydHMgY2FsbHMiKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBjYWxscyIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHJhaW5ib3dTREsud2ViUlRDLmhhc0FDYW1lcmEoKSkgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIHN1cHBvcnRzIHZpZGVvIik7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdmlkZW8iKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChyYWluYm93U0RLLndlYlJUQy5oYXNBTWljcm9waG9uZSgpKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkJyb3dzZXIgc3VwcG9ydHMgbWljcm9waG9uZSIpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IG1pY3JvcGhvbmUiKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMgLy9hdXRob3Jpc2UgdGhlIGFwcGxpY2F0aW9uIHRvIGFjY2VzcyBtZWRpYSBkZXZpY2UNCiAgICAgICAgICAgICAgICAuZ2V0VXNlck1lZGlhKHsgYXVkaW86IHRydWUsIHZpZGVvOiB0cnVlIH0pDQogICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7DQogICAgICAgICAgICAgICAgICAgIHN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uKHRyYWNrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0cmFjay5zdG9wKCk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzDQogICAgICAgICAgICAgICAgICAgICAgICAuZW51bWVyYXRlRGV2aWNlcygpDQogICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkZXZpY2VzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uKGRldmljZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkZXZpY2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGV2aWNlLmRldmljZUlkID09PSAiZGVmYXVsdCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRldmljZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkZXZpY2UubGFiZWwsICJpcyBhdmFpbGFibGUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLnVzZU1pY3JvcGhvbmUoImRlZmF1bHQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLnVzZVNwZWFrZXIoImRlZmF1bHQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhaW5ib3dTREsud2ViUlRDLnVzZUNhbWVyYSgiZGVmYXVsdCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICBzdGFydENhbGw6IGFzeW5jIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzOw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLiRzdG9yZS5zdGF0ZS5hZ2VudElkKTsNCiAgICAgICAgICAgICAgICBsZXQgY29udGFjdCA9IGF3YWl0IHJhaW5ib3dTREsuY29udGFjdHMuc2VhcmNoQnlJZCgNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuYWdlbnRJZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coY29udGFjdCk7DQogICAgICAgICAgICAgICAgLy8gbGV0IHJlcyA9IHJhaW5ib3dTREsud2ViUlRDLmNhbGxJbkF1ZGlvKGNvbnRhY3QpOw0KICAgICAgICAgICAgICAgIC8vIGlmIChyZXMubGFiZWwgPT09ICJPSyIpIHsNCiAgICAgICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coImNhbGxpbmciKTsNCiAgICAgICAgICAgICAgICAvLyB9DQogICAgICAgICAgICAgICAgbGV0IHJlcyA9IHJhaW5ib3dTREsud2ViUlRDLmNhbGxJblZpZGVvKGNvbnRhY3QpOw0KICAgICAgICAgICAgICAgIGlmIChyZXMubGFiZWwgPT09ICJPSyIpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImNhbGxpbmciKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigNCiAgICAgICAgICAgICAgICAgICAgcmFpbmJvd1NESy53ZWJSVEMuUkFJTkJPV19PTldFQlJUQ0VSUk9SSEFORExFRCwNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5vbldlYlJUQ0Vycm9ySGFuZGxlZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigNCiAgICAgICAgICAgICAgICAgICAgcmFpbmJvd1NESy53ZWJSVEMuUkFJTkJPV19PTldFQlJUQ0NBTExTVEFURUNIQU5HRUQsDQogICAgICAgICAgICAgICAgICAgIHNlbGYub25XZWJSVENDYWxsQ2hhbmdlZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgc2VsZi5zdGFydCA9IHRydWU7DQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBvbldlYlJUQ0NhbGxDaGFuZ2VkOiBmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgbGV0IHNlbGYgPSB0aGlzOw0KICAgICAgICAgICAgc2VsZi5jYWxsID0gZXZlbnQuZGV0YWlsOw0KICAgICAgICAgICAgY29uc29sZS5sb2coIk9uV2ViUlRDQ2FsbENoYW5nZWQgZXZlbnQiLCBldmVudC5kZXRhaWwuc3RhdHVzKTsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuY2FsbC5zdGF0dXMudmFsdWUpOw0KICAgICAgICB9DQogICAgfSwNCiAgICBvbldlYlJUQ0Vycm9ySGFuZGxlZDogZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgbGV0IGVycm9yU0RLID0gZXZlbnQuZGV0YWlsOw0KICAgICAgICBjb25zb2xlLmxvZygiV2ViUlRDIEVSUk9SOiAiLCBlcnJvclNESyk7DQogICAgfSwNCiAgICBlbmRDYWxsOiBhc3luYyBmdW5jdGlvbigpIHsNCiAgICAgICAgbGV0IHNlbGYgPSB0aGlzOw0KICAgICAgICBzZWxmLmV4aXQgPSB0cnVlOw0KICAgICAgICBhd2FpdCByYWluYm93U0RLLndlYlJUQy5yZWxlYXNlKHNlbGYuY2FsbCk7DQogICAgICAgIGNvbnNvbGUubG9nKCJTZXNzaW9uIEVuZGVkIik7DQogICAgfSwNCiAgICBtb3ZlVG9DaGF0OiBhc3luYyBmdW5jdGlvbigpIHsNCiAgICAgICAgY29uc29sZS5sb2coIm1vdmluZyB0byBjaGF0Iik7DQogICAgICAgIGF3YWl0IHJhaW5ib3dTREsud2ViUlRDLnJlbGVhc2UodGhpcy5jYWxsKTsNCiAgICAgICAgYXdhaXQgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiY2hhdGJvdCIgfSk7DQogICAgfQ0KfTsNCg=="},{"version":3,"sources":["Call.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Call.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <v-app>\r\n        <div class=\"text-center\">\r\n            <div class=\"call\" id=\"call\">\r\n                <transition name=\"fade\">\r\n                    <Waitpage\r\n                        v-bind:isConnecting=\"isConnecting\"\r\n                        v-if=\"!start\"\r\n                    />\r\n                </transition>\r\n\r\n                <audio id=\"globalAudioTag\" autoplay></audio>\r\n                <video id=\"largevideo\" autoplay></video>\r\n                <video\r\n                    id=\"globalVideoTag\"\r\n                    autoplay\r\n                    style=\"display:none;\"\r\n                ></video>\r\n                <div class=\"text-center\">\r\n                    <v-footer width=\"100%\" padless>\r\n                        <!-- <v-btn\r\n                            id=\"endcall\"\r\n                            @click=\"endCall\"\r\n                            height=\"58px\"\r\n                            width=\"100%\"\r\n                            x-large\r\n                            depressed\r\n                            tile\r\n                        >\r\n                            <h3>End Call</h3>\r\n                        </v-btn> -->\r\n\r\n                        <v-btn\r\n                            size=\"lg\"\r\n                            name=\"button\"\r\n                            class=\"mx-2\"\r\n                            fab\r\n                            dark\r\n                            x-large\r\n                            color=\"blue darken-2\"\r\n                        >\r\n                            <v-icon dark>mdi-message-text</v-icon>\r\n                        </v-btn>\r\n                    </v-footer>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </v-app>\r\n</template>\r\n\r\n<script>\r\nimport rainbowSDK from \"rainbow-web-sdk\";\r\n// import axios from \"axios\";\r\n\r\nexport default {\r\n    name: \"Call\",\r\n    components: {},\r\n    data: () => ({\r\n        start: false,\r\n        isConnecting: false,\r\n        cancelled: false,\r\n        call: \"\",\r\n        exit: false\r\n    }),\r\n    mounted() {\r\n        let self = this;\r\n        self.checkCall();\r\n        if (this.$store.state.agentId != \"\") {\r\n            self.isConnecting = true;\r\n            self.startCall();\r\n        } else {\r\n            console.log(\"agent id empty\");\r\n        }\r\n    },\r\n    methods: {\r\n        checkCall: function() {\r\n            if (rainbowSDK.webRTC.canMakeAudioVideoCall()) {\r\n                console.log(\"Browser supports calls\");\r\n            } else {\r\n                console.log(\"Browser does not support calls\");\r\n            }\r\n            if (rainbowSDK.webRTC.hasACamera()) {\r\n                console.log(\"Browser supports video\");\r\n            } else {\r\n                console.log(\"Browser does not support video\");\r\n            }\r\n            if (rainbowSDK.webRTC.hasAMicrophone()) {\r\n                console.log(\"Browser supports microphone\");\r\n            } else {\r\n                console.log(\"Browser does not support microphone\");\r\n            }\r\n            navigator.mediaDevices //authorise the application to access media device\r\n                .getUserMedia({ audio: true, video: true })\r\n                .then(function(stream) {\r\n                    stream.getTracks().forEach(function(track) {\r\n                        track.stop();\r\n                    });\r\n                    navigator.mediaDevices\r\n                        .enumerateDevices()\r\n                        .then(function(devices) {\r\n                            devices.forEach(function(device) {\r\n                                console.log(device);\r\n                                if (device.deviceId === \"default\") {\r\n                                    console.log(device);\r\n                                    console.log(device.label, \"is available\");\r\n                                    rainbowSDK.webRTC.useMicrophone(\"default\");\r\n                                    rainbowSDK.webRTC.useSpeaker(\"default\");\r\n                                    rainbowSDK.webRTC.useCamera(\"default\");\r\n                                }\r\n                            });\r\n                        })\r\n                        .catch(function(error) {\r\n                            console.log(error);\r\n                        });\r\n                })\r\n                .catch(function(error) {\r\n                    console.log(error);\r\n                });\r\n        },\r\n        startCall: async function() {\r\n            let self = this;\r\n            try {\r\n                console.log(this.$store.state.agentId);\r\n                let contact = await rainbowSDK.contacts.searchById(\r\n                    this.$store.state.agentId\r\n                );\r\n                console.log(contact);\r\n                // let res = rainbowSDK.webRTC.callInAudio(contact);\r\n                // if (res.label === \"OK\") {\r\n                //     console.log(\"calling\");\r\n                // }\r\n                let res = rainbowSDK.webRTC.callInVideo(contact);\r\n                if (res.label === \"OK\") {\r\n                    console.log(\"calling\");\r\n                }\r\n                document.addEventListener(\r\n                    rainbowSDK.webRTC.RAINBOW_ONWEBRTCERRORHANDLED,\r\n                    self.onWebRTCErrorHandled\r\n                );\r\n                document.addEventListener(\r\n                    rainbowSDK.webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED,\r\n                    self.onWebRTCCallChanged\r\n                );\r\n                self.start = true;\r\n            } catch (err) {\r\n                console.log(err);\r\n            }\r\n        },\r\n        onWebRTCCallChanged: function(event) {\r\n            let self = this;\r\n            self.call = event.detail;\r\n            console.log(\"OnWebRTCCallChanged event\", event.detail.status);\r\n            console.log(self.call.status.value);\r\n        }\r\n    },\r\n    onWebRTCErrorHandled: function(event) {\r\n        let errorSDK = event.detail;\r\n        console.log(\"WebRTC ERROR: \", errorSDK);\r\n    },\r\n    endCall: async function() {\r\n        let self = this;\r\n        self.exit = true;\r\n        await rainbowSDK.webRTC.release(self.call);\r\n        console.log(\"Session Ended\");\r\n    },\r\n    moveToChat: async function() {\r\n        console.log(\"moving to chat\");\r\n        await rainbowSDK.webRTC.release(this.call);\r\n        await this.$router.push({ name: \"chatbot\" });\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.call {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 100vh;\r\n    text-align: center;\r\n    padding: 20px;\r\n}\r\n.box {\r\n    height: 100%;\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    justify-items: center;\r\n    align-content: center;\r\n    overflow: auto;\r\n}\r\n.agent-text {\r\n    text-align: center;\r\n    position: absolute;\r\n    width: 100%;\r\n    margin-top: 150px;\r\n}\r\n.header {\r\n    background-color: #f1f1f1;\r\n    text-align: center;\r\n    font-size: 60px;\r\n    width: 100%;\r\n    transition: 0.2s;\r\n}\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n    transition: opacity 0.5s;\r\n}\r\n.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {\r\n    opacity: 0;\r\n}\r\n</style>\r\n"]}]}